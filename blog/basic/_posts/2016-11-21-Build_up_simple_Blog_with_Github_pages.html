---
layout: blog
title: 博客搭建记录
excerpt: >
  Github Pages是Github提供的一个静态网页空间，利用Github Pages可以快速的创建属于你自己的个人博客站点，而且完全免费。
  那么我是如何利用Github Pages搭建本站点的呢？
tags: Jekyll git github Liquid
chapters: [创建站点仓库, 利用Jekyll生成站点, 发布站点]
published: true
scripts: [prism.default.basic]
styles: [prism.default.basic]
---

{% include blog_head.html %}
<hr>
<div class="blog-body">
  <div class="chapter-item">
    <a name="创建站点仓库"></a>
    <h2 class="chapter-title">创建站点仓库</h2>
    <article>
      <p>
        <a href="https://pages.github.com" target="_blank">Github Pages</a>
        寄存着基于仓库生成的用户、组织或项目站点页面。站点大体可以分为两种类型：用户/组织站点和项目站点。
        更多具体细节可查阅Github Pages的帮助文档<sup><a href="#ref_1">1</a></sup>。
      </p>
      <h3>username.github.io</h3>
      <p>
        用户站点需要创建在一个指定命名为username.github.io的仓库中，username即账户名称。
        这个仓库的master分支将被用于创建和发布用户站点。
        创建完成后在仓库的master分支下新建一个文件：
      <pre><code class="language-markup">&lt;!-- file:index.html --&gt;
&lt;h1&gt;Hello World!&lt;/h1&gt;</code></pre>
      此时通过https://username.github.io就可以访问到刚刚创建的页面了。
      </p>
      <h3>项目站点</h3>
      <p>

      </p>
    </article>
  </div>
  <div class="chapter-item">
    <a name="利用Jekyll生成站点"></a>
    <h2 class="chapter-title">利用Jekyll生成站点</h2>
    <article>
      <h3>为什么用Jekyll</h3>
      <div>
        <p>
          <a href="http://jekyllrb.com/" target="_blank">Jekyll</a>是一个静态站点生成器，
          可以方便地将网页分解、组件化，并且支持高级模板特性和Jekyll主题。
          Github Pages支持 <strong>任何一种</strong> 静态站点生成器，
          而这其中Jekyll是文档中唯一提供详细描述的。
        </p>
        <p>
          在Jekyll的诸多优势中，我比较看重的是 利用Liquid模板引擎可以方便地组织站点数据结构，
          而站点的通用模板(如header、footer等)都是通过这一特性实现的。此外，
          还可以使用意读易写的Markdown代替HTML，并且可以在不引入CSS文件的前提下使用Jekyll主题等。
        </p>
      </div>
      <h3>搭建Jekyll本地工作环境</h3>
      <ol>
        <li>
           配置环境需求
           <p>
            Jekyll依赖于Ruby，所以安装前需要先搭建Ruby的运行环境。
            我个人是用RVM对Ruby进行版本管理，这里不再赘述，详情请参考官方文档
            <sup><a href="#ref_2">2</a></sup>。<br>
            Jekyll的最好安装方式是通过RubyGem:
            <code class="language-bash">
              $ gem install jekyll
            </code>
           </p>
        </li>
        <li>
          用命令行生成预定义配置的Jekyll项目
          <pre><code class="language-bash">$ jekyll new blog   # 创建新项目
$ cd blog   # 进入项目目录
$ jekyll server   # 开启本地服务器预览</code></pre>
          此时访问本地localhost:4000即可查看默认的Jekyll项目了。
        </li>
        更多Jekyll知识请查阅<a href="http://jekyllrb.com/docs/home/" target="_blank">官方文档</a>
        或 <a href="/blogs/basic/2016/11/23/Jekyll_detailed.html">Jekyll详解</a>。
      </ol>
      <h3>组织项目结构</h3>
      新建项目的目录结构:
      <ul class="dir-container">
        <li>
          _posts
          <span class="open-trigger">+</span>
          <ul class="dir-container hidden">
            <li>2016-11-23-welcome-to-jekyll.markdown</li>
          </ul>
        </li>
        <li>
          _site
          <span class="open-trigger">+</span>
          <ul class="dir-container hidden">
            <li>
              about
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>index.html</li>
              </ul>
            </li>
            <li>
              assets
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>main.css</li>
              </ul>
            </li>
            <li>
              jekyll
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>
                  update
                  <span class="open-trigger">-</span>
                  <ul class="dir-container">
                    <li>
                      2016
                      <span class="open-trigger">-</span>
                      <ul class="dir-container">
                        <li>
                          11
                          <span class="open-trigger">-</span>
                          <ul class="dir-container">
                            <li>
                              23
                              <span class="open-trigger">-</span>
                              <ul class="dir-container">
                                <li>
                                  welcome-to-jekyll.html
                                </li>
                              </ul>
                            </li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>feed.xml</li>
            <li>feed.xslt.xml</li>
            <li>index.html</li>
          </ul>
        </li>
        <li>
          .sass-cache
          <span class="open-trigger">+</span>
          <ul class="dir-container hidden">
            <li>
              484c146ba927a3b31cdf6cafaee64c2e036cf3fc
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>_base.scssc</li>
                <li>_layout.scssc</li>
                <li>_syntax-highlighting.scssc</li>
              </ul>
            </li>
            <li>
              03198686e030127dddc53a6188a820a1a7f87a38
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>minima.scssc</li>
              </ul>
            </li>
          </ul>
        </li>
        <li>_config.yml</li>
        <li>.gitignore</li>
        <li>about.md</li>
        <li>Gemfile</li>
        <li>Gemfile.lock</li>
        <li>index.md</li>
      </ul>
      <p>
        要完成项目需求，单靠预定义配置生成的结构还是太单薄了，需要对目录结构和数据结构进行进一步的完善。
      </p>
      <ol>
        <li>
          目录结构
          <ul class="dir-container">
            <li>_config.yml</li>
            <li>
              _drafts
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>Liquid_detailed.html</li>
                <li>Jekyll_detailed.html</li>
              </ul>
            </li>
            <li>
              _includes
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>header.html</li>
                <li>footer.html</li>
              </ul>
            </li>
            <li>
              _layouts
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>default.html</li>
                <li>post.html</li>
                <li>project.html</li>
              </ul>
            </li>
            <li>
              _posts
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>
                  blogs
                  <span class="open-trigger">-</span>
                  <ul class="dir-container">
                    <li>2016-11-23-Build_up_Github_Pages.html</li>
                  </ul>
                </li>
                <li>
                  projects
                  <span class="open-trigger">-</span>
                  <ul class="dir-container">
                    <li>2016-11-24-SVG_icon_font.html</li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              about
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>index.html</li>
              </ul>
            </li>
            <li>
              blogs
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>index.html</li>
              </ul>
            </li>
            <li>
              projects
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>index.html</li>
              </ul>
            </li>
            <li>
              assets
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>main.css</li>
                <li>main.js</li>
              </ul>
            </li>
            <li>
              tags
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>index.html</li>
              </ul>
            </li>
            <li>
              categories
              <span class="open-trigger">-</span>
              <ul class="dir-container">
                <li>index.html</li>
              </ul>
            </li>
            <li>index.html</li>
          </ul>
          <p>
            在这个结构中，除了Jekyll功能性的目录(_drafts、_posts、_layouts、_includes)外，
            我还定义了blogs、projects、tags等文件夹，用于存放单独的页面，assets用于存放静态文件。
          </p>
        </li>
        <li>
          数据结构
          <p>
            站点数据结构的组织全靠 <a href="https://shopify.github.io/liquid/" target="_blank">Liquid</a> 模板语法
            、每篇文章的<a href="http://www.yaml.org/" target="_blank">YAML</a>头信息，
            以及站点配置文件_config.yml。
          </p>
          <p>
            Liquid
            <sup><a href="#ref_3">3</a></sup>
            是一个应特殊需求而生的模板引擎。
            它有两种标记类型：
          </p>
          <ul>
            <li>
              Output标记，用于输出文本，格式采用 {% raw %}{{ 两个尖括号包围 }}{% endraw %}
            </li>
            <li>
              Tag标记，用于执行命令或者处理格式: {% raw %}{% 一对尖括号内一对百分号 %}{% endraw %}
            </li>
          </ul>
          <div>
            <p>
              _config.yml配置文件<br>
              新创建的项目中并没有定义样式，但是仍然渲染出了/_site/assets/main.css文件，
              所有的样式都是基于配置文件中指定的主题生成的。
              除此之外，配置文件还定义了其他一些站点信息和渲染配置等配置项。
              <pre><code class="language-yaml"># _config.yml

# 站点设置(Site setting)
# 这里的变量可以在页面中通过Output标记调用，如:{% raw %}{{ site.title }}{% endraw %}
# 可以创建任意的自定义变量variables，然后通过{% raw %}{{ site.variables }}{% endraw %}调用。

title: "Ouhsub" # 站点标题
email: "ouhsub.gmail.com" # 邮箱地址
description: > # 这个符号(>)表示定义多行。
  Write an awesome description for your new site here. You can edit this
  line in _config.yml. It will appear in your document head meta (for
  Google search results) and in your feed.xml site description.
baseurl: "/projects" # 站点子路径 e.g. /blog
url: "https://ouhsub.github.io" # 站点的主机名和协议, e.g. http://example.com
custome_variable: "value" # 自定义变量。

# 渲染设置(Build settings)
markdown: kramdown
theme: minima
gems:
  - jekyll-feed
exclude:
  - Gemfile
  - Gemfile.lock</code></pre>
            </p>
            我的config文件是留空的，并没有使用任何主题或设置任何全站的变量。
          </div>

          <p>YAML头信息是定义在每篇文章头部的，用上下三个短横线包围的配置信息，如：
            <pre><code class="language-markup">&lt;!-- 2016-11-23-Build_up_Github_Pages.html --&gt;</code><code class="language-yaml">
---
layout: blog
title: 博客搭建记录
categories: blogs basic
excerpt: >
  Github Pages是Github提供的一个静态网页空间，
  利用Github Pages可以快速的创建属于你自己的个人博客站点，
  而且完全免费。
  那么我是如何利用Github Pages搭建本站点的呢？
tags: Jekyll git github Liquid
chapters: [创建站点仓库, 利用Jekyll生成站点, 发布站点]
published: true
script: prism.default.basic
style: prism.default.basic
---</code></pre>
            每篇文章的YAML头信息中定义的变量都可以通过对文章的引用(page或任意其他标识符){% raw %}{{ page.variables }}{% endraw %}调用，
            要与站点的YAML变量调用{% raw %}{{ site.variables }}{% endraw %}区别开。
          </p>
          <p>
            首页的数据需求是列出最新发表的10篇blog文章，而不包括projects中的项目。可以这样写咯：
            <pre><code class="language-markup">&lt;!-- index.html --&gt;
---
layout: default
title: 首页 | Ouhsub
---

&lt;div&gt;
  &lt;h1&gt;最新文章&lt;/h1&gt;
  &lt;div&gt;
    &lt;ul&gt;
      {% raw %}{% for category in site.categories %}
        {% if category[0] == 'blogs' %}
          {% assign pages_list = category[1] %}
          {% for node in pages_list limit:10 %}{% endraw %}
          &lt;li&gt;
            &lt;div&gt;
              &lt;a href="{% raw %}{{ BASE_PATH }}{{{node.url}}{% endraw %}"&gt;
                &lt;h2&gt;{% raw %}{{ node.title }}{% endraw %}&lt;/h2&gt;
                &lt;p&gt;{% raw %}{{ node.excerpt }}{% endraw %}&lt;/p&gt;
              &lt;/a&gt;
            &lt;/div&gt;
          &lt;/li&gt;
          {% raw %}{% endfor %}
        {% endif %}
      {% endfor %}{% endraw %}
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
            这里先遍历了站点所有的categories，
            然后拿到类目(category[0])为blogs的所有文章(category[1])，
            将文章列表赋值给变量page_list,
            最后遍历page_list，输出每篇文章的各项信息，并使用 limit:10 过滤器限制了输出数量。
          </p>
          <p>
            其余blog页面、project页面、以及分类，标签页也都是使用类似的结构来实现的。
          </p>
        </li>
      </ol>
      <h3>编辑博客内容</h3>
      <ol>
        <li>
          头信息
          <p>
            <pre><code class="language-markup">&lt;!-- 2016-11-23-Build_up_Github_Pages.html --&gt;</code><code class="language-yaml">
---
layout: blog
title: 博客搭建记录
categories: blogs basic
excerpt: >
  Github Pages是Github提供的一个静态网页空间，
  利用Github Pages可以快速的创建属于你自己的个人博客站点，
  而且完全免费。
  那么我是如何利用Github Pages搭建本站点的呢？
tags: Jekyll git github Liquid
chapters: [创建站点仓库, 利用Jekyll生成站点, 发布站点]
published: true
script: prism.default.basic
style: prism.default.basic
---</code></pre>
            这个文件的头信息中9个变量：
            <ul>
              <li>layout: 指定页面使用的模板</li>
              <li>title: 定义页面变量title</li>
              <li>categories: 指定文章类目</li>
              <li>tags: 指定文章标签</li>
              <li>excerpt: 定义摘要变量，以覆盖自动生成的摘要</li>
              <li>published: 是否发表文章</li>
              <li>chapters: 自定义变量，存储着章节数组</li>
              <li>script: 自定义变量，用来加载JS文件</li>
              <li>style: 自定义数组，用来加载CSS文件</li>
            </ul>
          </p>
        </li>
        <li>
          写文章
          <p>
            在YAML信息头下面，就可以使用喜欢的语言编写文章内容咯。
            Jekyll支持2种流行的标记语言格式： Markdown 和 Textile。
            不过我还是比较习惯用HTML来写。
          </p>
        </li>
        <li>
          草稿
          <p>
            保存在_drafts目录下的文件就是草稿。<br>
            运行<code class="language-bash">$ jekyll server --drafts</code>
            或者<code class="language-bash">$ jekyll build --drafts</code>
            两种方法皆会将 Time.now 的值赋予草稿文章，作为其发布日期，生成最新文章。
          </p>
        </li>
        <li>
          静态页面
          <p>
            有两种方式建立静态页面：命名文件夹和命名文件。
            一般有about、contact等等页面。这两种方式基本相同，唯一区别就是访问URL不同。
          </p>
        </li>
      </ol>
    </article>
  </div>
  <div class="chapter-item">
    <a name="发布站点"></a>
    <h2 class="chapter-title">发布站点</h2>
    <article>
      <p>
        使用git命令将当前仓库push到github上就可以了。
      </p>
    </article>
  </div>
</div>
<hr>
<div class="blog-foot">
  <h3>相关文章</h3>
  <p class="link-item">
    <a href="">Liquid详解</a>
    <a href="">Jekyll详解</a>
    <a href="">YAML详解</a>
  </p>
  <h3>参考资料</h3>
  <p class="link-item">
    <a name="ref_1">1、</a>
    <a href="https://help.github.com/categories/github-pages-basics/" target="_blank">Github Pages帮助文档</a>
  </p>
  <p class="link-item">
    <a name="ref_2">2、</a>
    <a href="http://rvm.io/" target="_blank">RVM</a>
  </p>
  <p class="link-item">
    <a name="ref_3">3、</a>
    <a href="https://github.com/Shopify/liquid/wiki/Liquid-for-Designers" target="_blank">Liquid for Designers</a>
  </p>
</div>
